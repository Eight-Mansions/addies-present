#include "font.h"

const u8 widths[] = {
	0x09, // 0
	0x04, // 1
	0x09, // 2
	0x0A, // 3
	0x0A, // 4
	0x09, // 5
	0x09, // 6
	0x09, // 7
	0x0A, // 8
	0x09, // 9
	0x00, // 0x59
	0x00, // 0x5A
	0x00, // 0x5B
	0x00, // 0x5C
	0x00, // 0x5D
	0x00, // 0x5E
	0x00, // 0x5F, I hate them skipping around...
	0x0A, // A
	0x09, // B
	0x0A, // C
	0x09, // D
	0x08, // E
	0x08, // F
	0x0A, // G
	0x09, // H
	0x02, // I
	0x08, // J
	0x09, // K
	0x09, // L
	0x0B, // M
	0x09, // N
	0x0A, // O
	0x09, // P
	0x0A, // Q
	0x09, // R
	0x09, // S
	0x0A, // T
	0x09, // U
	0x0A, // V
	0x0C, // W
	0x09, // X
	0x0A, // Y
	0x09, // Z
	0x00, // 0x7A
	0x00, // 0x7B
	0x00, // 0x7C
	0x00, // 0x7D
	0x00, // 0x7E
	0x00, // 0x7F
	0x00, // 0x80
	0x08, // a
	0x08, // b
	0x07, // c
	0x08, // d
	0x08, // e
	0x06, // f
	0x08, // g
	0x07, // h
	0x02, // i
	0x04, // j
	0x07, // k
	0x02, // l
	0x0A, // m
	0x07, // n
	0x08, // o
	0x08, // p
	0x08, // q
	0x06, // r
	0x07, // s
	0x06, // t
	0x07, // u
	0x08, // v
	0x0A, // w
	0x07, // x
	0x08, // y
	0x07, // z
	0x00, // 0x9B
	0x00, // 0x9C
	0x00, // 0x9D
	0x00, // 0x9E
	0x04, // space
	0x03, // ,
	0x02, // .
	0x02, // :
	0x03, // ;
	0x08, // ?
	0x03, // !
	0x04, // "
	0x04, // -
	0x03, // '
	0x05, // (
	0x05 // )
};

int GetLetterWidth(const u32 letter)
{
	if (letter >= 0x824F && letter <= 0x82AA)
	{
		u32 idx = letter - 0x824F;
		return widths[idx];
	}
	else
	{
		return 0x0F;
	}
}

int GetSentenceWidth(const char* text, u32 length)
{
	int textWidth = 0;
	for (int i = 0; i < length; i++) // There is also a check for <$09> but not sure what that does... maybe breaks too?
	{
		int letter = 0;
		
		if (text[i] == 0x0A || text[i] == 0x00)
			break;

		if (text[i] > 0x80)
		{  letter = (text[i] << 0x8) + text[i + 1];
			i++;
		}
		else
		{
			letter = text[i] + 0x824F;
		}

		textWidth += GetLetterWidth(letter);
	}
	return textWidth;
}

int GetYForCentering(const char* text, u32 length)
{
	u32 textwidth = GetSentenceWidth(text, length);

	return (int)((256 >> 1) - (textwidth >> 1)); // 256 is the width of text box texture
}